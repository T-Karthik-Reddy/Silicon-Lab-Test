============================================================
Training Started: 2025-11-20 12:49:24
============================================================
Architecture: Transformer-based Classifier (TensorFlow)
Using device: CPU

Loading dataset...
 cry: 2093 files
 not_cry: 2093 files

Calculating normalization statistics from training data...
Train: 2930, Val: 628, Test: 628
Normalization stats - Mean: -49.7618, Std: 16.7648

Loading dataset...
 cry: 2093 files
 not_cry: 2093 files

Calculating normalization statistics from training data...
Train: 2930, Val: 628, Test: 628
Normalization stats - Mean: -49.7618, Std: 16.7648

Class distribution:
 Class 0 (cry): 1465 samples (50.0%)
 Class 1 (not_cry): 1465 samples (50.0%)
Class weights: {0: 1.0, 1: 1.0}

Saved normalization stats - Mean: -49.7618, Std: 16.7648

Model parameters: 15,066
✓ Within parameter budget (1,934 remaining)

============================================================
Starting Training Loop
============================================================

============================================================
Epoch 1/100
============================================================

Train - Loss: 0.5304 | Acc: 0.7427 | F1: 0.7419
Train Confusion Matrix:
[[1006  459]
 [ 295 1170]]

Val  - Loss: 0.4123 | Acc: 0.8503 | F1: 0.8496 | AUC: 0.9017
Val Confusion Matrix:
[[246  68]
 [ 26 288]]
LR: 0.000300
✓ Saved best model with F1: 0.8496, Acc: 0.8503

============================================================
Epoch 2/100
============================================================

Train - Loss: 0.3537 | Acc: 0.8652 | F1: 0.8651
Train Confusion Matrix:
[[1239  226]
 [ 169 1296]]

Val  - Loss: 0.3528 | Acc: 0.8838 | F1: 0.8836 | AUC: 0.9346
Val Confusion Matrix:
[[288  26]
 [ 47 267]]
LR: 0.000300
✓ Saved best model with F1: 0.8836, Acc: 0.8838

============================================================
Epoch 3/100
============================================================

Train - Loss: 0.2774 | Acc: 0.8990 | F1: 0.8989
Train Confusion Matrix:
[[1343  122]
 [ 174 1291]]

Val  - Loss: 0.3125 | Acc: 0.9108 | F1: 0.9107 | AUC: 0.9462
Val Confusion Matrix:
[[300  14]
 [ 42 272]]
LR: 0.000300
✓ Saved best model with F1: 0.9107, Acc: 0.9108

============================================================
Epoch 4/100
============================================================

Train - Loss: 0.2583 | Acc: 0.9061 | F1: 0.9061
Train Confusion Matrix:
[[1355  110]
 [ 165 1300]]

Val  - Loss: 0.3063 | Acc: 0.9188 | F1: 0.9185 | AUC: 0.9523
Val Confusion Matrix:
[[308   6]
 [ 45 269]]
LR: 0.000300
✓ Saved best model with F1: 0.9185, Acc: 0.9188

============================================================
Epoch 5/100
============================================================

Train - Loss: 0.2385 | Acc: 0.9157 | F1: 0.9157
Train Confusion Matrix:
[[1371   94]
 [ 153 1312]]

Val  - Loss: 0.2479 | Acc: 0.9236 | F1: 0.9235 | AUC: 0.9577
Val Confusion Matrix:
[[300  14]
 [ 34 280]]
LR: 0.000300
✓ Saved best model with F1: 0.9235, Acc: 0.9236

============================================================
Epoch 6/100
============================================================

Train - Loss: 0.2259 | Acc: 0.9205 | F1: 0.9204
Train Confusion Matrix:
[[1376   89]
 [ 144 1321]]

Val  - Loss: 0.2543 | Acc: 0.9268 | F1: 0.9267 | AUC: 0.9583
Val Confusion Matrix:
[[300  14]
 [ 32 282]]
LR: 0.000300
✓ Saved best model with F1: 0.9267, Acc: 0.9268

============================================================
Epoch 7/100
============================================================

Train - Loss: 0.2156 | Acc: 0.9239 | F1: 0.9239
Train Confusion Matrix:
[[1379   86]
 [ 137 1328]]

Val  - Loss: 0.2273 | Acc: 0.9443 | F1: 0.9443 | AUC: 0.9627
Val Confusion Matrix:
[[301  13]
 [ 22 292]]
LR: 0.000300
✓ Saved best model with F1: 0.9443, Acc: 0.9443

============================================================
Epoch 8/100
============================================================

Train - Loss: 0.2025 | Acc: 0.9328 | F1: 0.9328
Train Confusion Matrix:
[[1388   77]
 [ 120 1345]]

Val  - Loss: 0.2286 | Acc: 0.9363 | F1: 0.9363 | AUC: 0.9645
Val Confusion Matrix:
[[296  18]
 [ 22 292]]
LR: 0.000300
Patience: 1/15

============================================================
Epoch 9/100
============================================================

Train - Loss: 0.1983 | Acc: 0.9290 | F1: 0.9290
Train Confusion Matrix:
[[1379   86]
 [ 122 1343]]

Val  - Loss: 0.2006 | Acc: 0.9490 | F1: 0.9490 | AUC: 0.9686
Val Confusion Matrix:
[[305   9]
 [ 23 291]]
LR: 0.000300
✓ Saved best model with F1: 0.9490, Acc: 0.9490

============================================================
Epoch 10/100
============================================================

Train - Loss: 0.1886 | Acc: 0.9389 | F1: 0.9389
Train Confusion Matrix:
[[1392   73]
 [ 106 1359]]

Val  - Loss: 0.2117 | Acc: 0.9459 | F1: 0.9458 | AUC: 0.9691
Val Confusion Matrix:
[[306   8]
 [ 26 288]]
LR: 0.000300
Patience: 1/15

============================================================
Epoch 11/100
============================================================

Train - Loss: 0.1794 | Acc: 0.9396 | F1: 0.9396
Train Confusion Matrix:
[[1398   67]
 [ 110 1355]]

Val  - Loss: 0.2120 | Acc: 0.9475 | F1: 0.9474 | AUC: 0.9685
Val Confusion Matrix:
[[305   9]
 [ 24 290]]
LR: 0.000300
Patience: 2/15

============================================================
Epoch 12/100
============================================================

Train - Loss: 0.1703 | Acc: 0.9403 | F1: 0.9403
Train Confusion Matrix:
[[1402   63]
 [ 112 1353]]

Val  - Loss: 0.2672 | Acc: 0.9188 | F1: 0.9187 | AUC: 0.9675
Val Confusion Matrix:
[[279  35]
 [ 16 298]]
LR: 0.000300
Patience: 3/15

============================================================
Epoch 13/100
============================================================

Train - Loss: 0.1680 | Acc: 0.9488 | F1: 0.9488
Train Confusion Matrix:
[[1411   54]
 [  96 1369]]

Val  - Loss: 0.2203 | Acc: 0.9427 | F1: 0.9427 | AUC: 0.9699
Val Confusion Matrix:
[[295  19]
 [ 17 297]]
LR: 0.000300
Patience: 4/15

============================================================
Epoch 14/100
============================================================

Train - Loss: 0.1589 | Acc: 0.9509 | F1: 0.9508
Train Confusion Matrix:
[[1411   54]
 [  90 1375]]

Val  - Loss: 0.2202 | Acc: 0.9459 | F1: 0.9459 | AUC: 0.9710
Val Confusion Matrix:
[[299  15]
 [ 19 295]]
LR: 0.000300
Patience: 5/15

============================================================
Epoch 15/100
============================================================

Train - Loss: 0.1555 | Acc: 0.9474 | F1: 0.9474
Train Confusion Matrix:
[[1408   57]
 [  97 1368]]

Val  - Loss: 0.2129 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9737
Val Confusion Matrix:
[[302  12]
 [ 19 295]]
LR: 0.000300
✓ Saved best model with F1: 0.9506, Acc: 0.9506

============================================================
Epoch 16/100
============================================================

Train - Loss: 0.1485 | Acc: 0.9522 | F1: 0.9522
Train Confusion Matrix:
[[1416   49]
 [  91 1374]]

Val  - Loss: 0.2411 | Acc: 0.9379 | F1: 0.9379 | AUC: 0.9725
Val Confusion Matrix:
[[291  23]
 [ 16 298]]
LR: 0.000300
Patience: 1/15

============================================================
Epoch 17/100
============================================================

Train - Loss: 0.1662 | Acc: 0.9481 | F1: 0.9481
Train Confusion Matrix:
[[1403   62]
 [  90 1375]]

Val  - Loss: 0.2139 | Acc: 0.9459 | F1: 0.9459 | AUC: 0.9745
Val Confusion Matrix:
[[297  17]
 [ 17 297]]
LR: 0.000300
Patience: 2/15

============================================================
Epoch 18/100
============================================================

Train - Loss: 0.1467 | Acc: 0.9536 | F1: 0.9536
Train Confusion Matrix:
[[1413   52]
 [  84 1381]]

Val  - Loss: 0.2113 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9761
Val Confusion Matrix:
[[302  12]
 [ 19 295]]
LR: 0.000300
Patience: 3/15

============================================================
Epoch 19/100
============================================================

Train - Loss: 0.1513 | Acc: 0.9519 | F1: 0.9519
Train Confusion Matrix:
[[1414   51]
 [  90 1375]]

Val  - Loss: 0.2140 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9787
Val Confusion Matrix:
[[307   7]
 [ 24 290]]
LR: 0.000300
Patience: 4/15

============================================================
Epoch 20/100
============================================================

Train - Loss: 0.1497 | Acc: 0.9522 | F1: 0.9522
Train Confusion Matrix:
[[1419   46]
 [  94 1371]]

Val  - Loss: 0.2017 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9772
Val Confusion Matrix:
[[301  13]
 [ 18 296]]
LR: 0.000300
✓ Saved best model with F1: 0.9506, Acc: 0.9506

============================================================
Epoch 21/100
============================================================

Train - Loss: 0.1268 | Acc: 0.9587 | F1: 0.9587
Train Confusion Matrix:
[[1426   39]
 [  82 1383]]

Val  - Loss: 0.2237 | Acc: 0.9459 | F1: 0.9459 | AUC: 0.9762
Val Confusion Matrix:
[[298  16]
 [ 18 296]]
LR: 0.000300
Patience: 1/15

============================================================
Epoch 22/100
============================================================

Train - Loss: 0.1363 | Acc: 0.9553 | F1: 0.9553
Train Confusion Matrix:
[[1420   45]
 [  86 1379]]

Val  - Loss: 0.2680 | Acc: 0.9299 | F1: 0.9299 | AUC: 0.9737
Val Confusion Matrix:
[[285  29]
 [ 15 299]]
LR: 0.000300
Patience: 2/15

============================================================
Epoch 23/100
============================================================

Train - Loss: 0.1511 | Acc: 0.9519 | F1: 0.9519
Train Confusion Matrix:
[[1409   56]
 [  85 1380]]

Val  - Loss: 0.2084 | Acc: 0.9490 | F1: 0.9490 | AUC: 0.9765
Val Confusion Matrix:
[[298  16]
 [ 16 298]]
LR: 0.000300
Patience: 3/15

============================================================
Epoch 24/100
============================================================

Train - Loss: 0.1394 | Acc: 0.9536 | F1: 0.9536
Train Confusion Matrix:
[[1421   44]
 [  92 1373]]

Val  - Loss: 0.2051 | Acc: 0.9490 | F1: 0.9490 | AUC: 0.9764
Val Confusion Matrix:
[[300  14]
 [ 18 296]]
LR: 0.000300
Patience: 4/15

============================================================
Epoch 25/100
============================================================

Train - Loss: 0.1278 | Acc: 0.9601 | F1: 0.9601
Train Confusion Matrix:
[[1417   48]
 [  69 1396]]

Val  - Loss: 0.1974 | Acc: 0.9554 | F1: 0.9554 | AUC: 0.9789
Val Confusion Matrix:
[[305   9]
 [ 19 295]]
LR: 0.000300
✓ Saved best model with F1: 0.9554, Acc: 0.9554

============================================================
Epoch 26/100
============================================================

Train - Loss: 0.1310 | Acc: 0.9584 | F1: 0.9584
Train Confusion Matrix:
[[1425   40]
 [  82 1383]]

Val  - Loss: 0.2300 | Acc: 0.9475 | F1: 0.9474 | AUC: 0.9773
Val Confusion Matrix:
[[300  14]
 [ 19 295]]
LR: 0.000300
Patience: 1/15

============================================================
Epoch 27/100
============================================================

Train - Loss: 0.1320 | Acc: 0.9584 | F1: 0.9584
Train Confusion Matrix:
[[1425   40]
 [  82 1383]]

Val  - Loss: 0.1960 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9791
Val Confusion Matrix:
[[300  14]
 [ 17 297]]
LR: 0.000300
Patience: 2/15

============================================================
Epoch 28/100
============================================================

Train - Loss: 0.1145 | Acc: 0.9611 | F1: 0.9611
Train Confusion Matrix:
[[1418   47]
 [  67 1398]]

Val  - Loss: 0.2032 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9785
Val Confusion Matrix:
[[299  15]
 [ 16 298]]
LR: 0.000300
Patience: 3/15

============================================================
Epoch 29/100
============================================================

Train - Loss: 0.1175 | Acc: 0.9608 | F1: 0.9607
Train Confusion Matrix:
[[1427   38]
 [  77 1388]]

Val  - Loss: 0.2023 | Acc: 0.9490 | F1: 0.9490 | AUC: 0.9796
Val Confusion Matrix:
[[296  18]
 [ 14 300]]
LR: 0.000300
Patience: 4/15

============================================================
Epoch 30/100
============================================================

Train - Loss: 0.1207 | Acc: 0.9631 | F1: 0.9631
Train Confusion Matrix:
[[1431   34]
 [  74 1391]]

Val  - Loss: 0.2348 | Acc: 0.9395 | F1: 0.9395 | AUC: 0.9780
Val Confusion Matrix:
[[289  25]
 [ 13 301]]
LR: 0.000300
Patience: 5/15

============================================================
Epoch 31/100
============================================================

Train - Loss: 0.1225 | Acc: 0.9618 | F1: 0.9618
Train Confusion Matrix:
[[1428   37]
 [  75 1390]]

Val  - Loss: 0.1995 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9808
Val Confusion Matrix:
[[299  15]
 [ 16 298]]
LR: 0.000300
Patience: 6/15
Reducing learning rate to 0.0001500000071246177

============================================================
Epoch 32/100
============================================================

Train - Loss: 0.1034 | Acc: 0.9672 | F1: 0.9672
Train Confusion Matrix:
[[1437   28]
 [  68 1397]]

Val  - Loss: 0.2281 | Acc: 0.9490 | F1: 0.9490 | AUC: 0.9788
Val Confusion Matrix:
[[295  19]
 [ 13 301]]
LR: 0.000150
Patience: 7/15

============================================================
Epoch 33/100
============================================================

Train - Loss: 0.1090 | Acc: 0.9625 | F1: 0.9625
Train Confusion Matrix:
[[1430   35]
 [  75 1390]]

Val  - Loss: 0.2060 | Acc: 0.9522 | F1: 0.9522 | AUC: 0.9800
Val Confusion Matrix:
[[299  15]
 [ 15 299]]
LR: 0.000150
Patience: 8/15

============================================================
Epoch 34/100
============================================================

Train - Loss: 0.0984 | Acc: 0.9683 | F1: 0.9683
Train Confusion Matrix:
[[1436   29]
 [  64 1401]]

Val  - Loss: 0.2316 | Acc: 0.9490 | F1: 0.9490 | AUC: 0.9786
Val Confusion Matrix:
[[294  20]
 [ 12 302]]
LR: 0.000150
Patience: 9/15

============================================================
Epoch 35/100
============================================================

Train - Loss: 0.1167 | Acc: 0.9621 | F1: 0.9621
Train Confusion Matrix:
[[1430   35]
 [  76 1389]]

Val  - Loss: 0.1987 | Acc: 0.9570 | F1: 0.9570 | AUC: 0.9807
Val Confusion Matrix:
[[301  13]
 [ 14 300]]
LR: 0.000150
✓ Saved best model with F1: 0.9570, Acc: 0.9570

============================================================
Epoch 36/100
============================================================

Train - Loss: 0.1115 | Acc: 0.9655 | F1: 0.9655
Train Confusion Matrix:
[[1432   33]
 [  68 1397]]

Val  - Loss: 0.2122 | Acc: 0.9554 | F1: 0.9554 | AUC: 0.9793
Val Confusion Matrix:
[[301  13]
 [ 15 299]]
LR: 0.000150
Patience: 1/15

============================================================
Epoch 37/100
============================================================

Train - Loss: 0.0994 | Acc: 0.9686 | F1: 0.9686
Train Confusion Matrix:
[[1439   26]
 [  66 1399]]

Val  - Loss: 0.2045 | Acc: 0.9522 | F1: 0.9522 | AUC: 0.9806
Val Confusion Matrix:
[[300  14]
 [ 16 298]]
LR: 0.000150
Patience: 2/15

============================================================
Epoch 38/100
============================================================

Train - Loss: 0.1018 | Acc: 0.9693 | F1: 0.9693
Train Confusion Matrix:
[[1433   32]
 [  58 1407]]

Val  - Loss: 0.2643 | Acc: 0.9379 | F1: 0.9379 | AUC: 0.9786
Val Confusion Matrix:
[[288  26]
 [ 13 301]]
LR: 0.000150
Patience: 3/15

============================================================
Epoch 39/100
============================================================

Train - Loss: 0.1113 | Acc: 0.9652 | F1: 0.9652
Train Confusion Matrix:
[[1427   38]
 [  64 1401]]

Val  - Loss: 0.1943 | Acc: 0.9570 | F1: 0.9570 | AUC: 0.9802
Val Confusion Matrix:
[[302  12]
 [ 15 299]]
LR: 0.000150
Patience: 4/15

============================================================
Epoch 40/100
============================================================

Train - Loss: 0.1005 | Acc: 0.9703 | F1: 0.9703
Train Confusion Matrix:
[[1438   27]
 [  60 1405]]

Val  - Loss: 0.2063 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9803
Val Confusion Matrix:
[[299  15]
 [ 16 298]]
LR: 0.000150
Patience: 5/15

============================================================
Epoch 41/100
============================================================

Train - Loss: 0.0922 | Acc: 0.9703 | F1: 0.9703
Train Confusion Matrix:
[[1438   27]
 [  60 1405]]

Val  - Loss: 0.2009 | Acc: 0.9538 | F1: 0.9538 | AUC: 0.9803
Val Confusion Matrix:
[[299  15]
 [ 14 300]]
LR: 0.000150
Patience: 6/15
Reducing learning rate to 7.500000356230885e-05

============================================================
Epoch 42/100
============================================================

Train - Loss: 0.0960 | Acc: 0.9683 | F1: 0.9683
Train Confusion Matrix:
[[1433   32]
 [  61 1404]]

Val  - Loss: 0.2117 | Acc: 0.9522 | F1: 0.9522 | AUC: 0.9803
Val Confusion Matrix:
[[298  16]
 [ 14 300]]
LR: 0.000075
Patience: 7/15

============================================================
Epoch 43/100
============================================================

Train - Loss: 0.0896 | Acc: 0.9727 | F1: 0.9727
Train Confusion Matrix:
[[1446   19]
 [  61 1404]]

Val  - Loss: 0.2242 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9794
Val Confusion Matrix:
[[296  18]
 [ 13 301]]
LR: 0.000075
Patience: 8/15

============================================================
Epoch 44/100
============================================================

Train - Loss: 0.0955 | Acc: 0.9710 | F1: 0.9710
Train Confusion Matrix:
[[1439   26]
 [  59 1406]]

Val  - Loss: 0.2057 | Acc: 0.9522 | F1: 0.9522 | AUC: 0.9804
Val Confusion Matrix:
[[298  16]
 [ 14 300]]
LR: 0.000075
Patience: 9/15

============================================================
Epoch 45/100
============================================================

Train - Loss: 0.0897 | Acc: 0.9710 | F1: 0.9710
Train Confusion Matrix:
[[1438   27]
 [  58 1407]]

Val  - Loss: 0.2086 | Acc: 0.9538 | F1: 0.9538 | AUC: 0.9800
Val Confusion Matrix:
[[298  16]
 [ 13 301]]
LR: 0.000075
Patience: 10/15

============================================================
Epoch 46/100
============================================================

Train - Loss: 0.0975 | Acc: 0.9672 | F1: 0.9672
Train Confusion Matrix:
[[1433   32]
 [  64 1401]]

Val  - Loss: 0.2324 | Acc: 0.9459 | F1: 0.9459 | AUC: 0.9791
Val Confusion Matrix:
[[293  21]
 [ 13 301]]
LR: 0.000075
Patience: 11/15

============================================================
Epoch 47/100
============================================================

Train - Loss: 0.0982 | Acc: 0.9672 | F1: 0.9672
Train Confusion Matrix:
[[1430   35]
 [  61 1404]]

Val  - Loss: 0.2096 | Acc: 0.9522 | F1: 0.9522 | AUC: 0.9803
Val Confusion Matrix:
[[298  16]
 [ 14 300]]
LR: 0.000075
Patience: 12/15

============================================================
Epoch 48/100
============================================================

Train - Loss: 0.0944 | Acc: 0.9703 | F1: 0.9703
Train Confusion Matrix:
[[1439   26]
 [  61 1404]]

Val  - Loss: 0.2018 | Acc: 0.9570 | F1: 0.9570 | AUC: 0.9806
Val Confusion Matrix:
[[300  14]
 [ 13 301]]
LR: 0.000075
Patience: 13/15

============================================================
Epoch 49/100
============================================================

Train - Loss: 0.0969 | Acc: 0.9706 | F1: 0.9706
Train Confusion Matrix:
[[1442   23]
 [  63 1402]]

Val  - Loss: 0.2220 | Acc: 0.9490 | F1: 0.9490 | AUC: 0.9795
Val Confusion Matrix:
[[296  18]
 [ 14 300]]
LR: 0.000075
Patience: 14/15

============================================================
Epoch 50/100
============================================================

Train - Loss: 0.0932 | Acc: 0.9700 | F1: 0.9700
Train Confusion Matrix:
[[1438   27]
 [  61 1404]]

Val  - Loss: 0.2283 | Acc: 0.9506 | F1: 0.9506 | AUC: 0.9795
Val Confusion Matrix:
[[297  17]
 [ 14 300]]
LR: 0.000075
Patience: 15/15

Early stopping triggered after 50 epochs

============================================================
Testing Best Model
============================================================

Final Test Results:
 Loss:   0.1578
 Accuracy: 0.9602 (96.02%)
 F1 Score: 0.9602
 AUC:    0.9893

Test Confusion Matrix:
[[300  14]
 [ 11 303]]

Per-Class Test Metrics:
 Cry class:
  Precision: 0.9646
  Recall:  0.9554
 Not Cry class:
  Precision: 0.9558
  Recall:  0.9650

============================================================
Training Completed: 2025-11-20 13:03:35
Best Val F1: 0.9570, Best Val Acc: 0.9570
Log saved to: /Users/theepireddykarthikreddy/Desktop/SILICON-1 copy/other_architectures/architecture4/logs/training_log_20251120_124924.txt
============================================================
